.\" SPDX-License-Identifier: GPL-3.0-or-later
.\" SPDX-FileCopyrightText: Sven Eckelmann <sven@narfation.org>
.TH "AP51-FLASH" "8" "August 29, 2019"
.\" Please adjust this date whenever revising the manpage.
.\" --------------------------------------------------------------------------
.\" Process this file with
.\" groff -man man/ap51-flash.8 -Tutf8
.\" Retrieve format warnings with
.\" LC_ALL=en_US.UTF-8 MANROFFSEQ='' MANWIDTH=80  man --warnings -E UTF-8 -l -Tutf8 -Z man/ap51-flash.8 >/dev/null
.\" --------------------------------------------------------------------------
.SH NAME
ap51\-flash \- firmware flasher for ethernet connected routers and access points
.SH SYNOPSIS
.na
.B ap51\-flash
[
.B \-vh
]
[
.B \-m
.I mac
]
[
.I interface
.I image
.I ...
]
.br
.ad
.SH DESCRIPTION
\fBap51\-flash\fP listens on traffic of a network \fIinterface\fP, detects
remote devices and checks the traffic for known identification markers. These
markers are send out automatically by supported devices during the initial boot
process of the embedded boot loader.

.PP
On success, it will search the list of provided \fIimage\fPs for a matching
firmware. A device specific communication procedure is initiated to begin the
flashing process. The firmware data is extracted from the selected \fIimage\fP
and transferred to the device in TFTP server or client mode.

.PP
\fBap51\-flash\fP will run in foreground and continue using the \fIinterface\fP
until it is interrupted by an SIGINT signal (typically generated by control-C)
or SIGTERM signal (for example generated by the
.BR kill(1)
command).

.PP
The \fIinterface\fP doesn't require a valid layer 3 network configuration but
has to be set in the UP state (using the
.BR ip\-link(8)
command). \fBap51\-flash\fP requires enough privileges to capture and inject
raw ethernet packets on the selected \fIinterface\fP. These are often only
accessible to the root user.

.PP
While \fBap51\-flash\fP doesn't require a target device specific network
configuration or TFTP client/server on the same machine, it is recommended
to disable any other TFTP client or server on the system running
\fBap51\-flash\fP to avoid interferences by a different TFTP program.

.SH OPTIONS
Listed below are the command line options for \fBap51\-flash\fP:

.TP
\fB\-m\fP \fImac\fP, \fB\--mac\fP \fImac\fP
Adds \fImac\fP address to the allowlist filter. Only these addresses will be
tried to be flashed when one or more addresses are supplied. The option
has to be supplied multiple times to add multiple addresses to the allowlist
filter. If not specified, all detected devices will be flashed.

.TP
.BR \-v ", " \-\-version
print ap51\-flash version and exit

.TP
.BR \-h ", " \-\-help
print ap51\-flash help and exit

.SH AUTHOR
ap51-flash was written by Marek Lindner and others. This manual page was written
by Sven Eckelmann <sven@narfation.org>. It is licensed under the terms of the
GNU GPL (version 3 or later).

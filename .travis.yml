# SPDX-License-Identifier: CC0-1.0
# SPDX-FileCopyrightText: Sven Eckelmann <sven@narfation.org>

sudo: required
dist: xenial
language: cpp
compiler:
  - gcc
  - clang
addons:
  apt:
    packages:
    - libpcap-dev
    - binutils
    - libc-bin

matrix:
    # osx native build
    - os: osx
      before_script:
      - dd if=/dev/urandom of=test.img count=10000 bs=1024
      script:
      - make clean V=s && make V=s ap51-flash-osx
      - make clean V=s && CPPFLAGS="-DDEBUG" make V=s ap51-flash-osx
      - make clean V=s && make V=s EMBED_CI="test.img" ap51-flash-osx
      - make clean V=s && CFLAGS="-flto -O2" make V=s ap51-flash-osx
